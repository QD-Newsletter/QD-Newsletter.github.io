!function(){var a="close";$(document).ready(function(){var e=$(".qd-v1-modal-newsletter");e.modal({backdrop:"static",keyboard:!1}),e.on("hidden.bs.modal",function(){window.parent.postMessage("QdSn2Msg|"+a,"*")})}),$(function(){var e=$("form"),n=(decodeURIComponent(window.location.search).match(/code=([^&]+)/)||[""]).pop();console.log("code",n),e.find('input[name="weddingAnniversary"], input[name="birthdate"]').mask("00/00/0000"),e.find('input[name="rg"]').mask("00.000.000-0"),e.find('input[name="cpf"]').mask("000.000.000-00"),e.find('input[name="cpf"]').mask("000.000.000-00"),e.find('input[name="cep"]').mask("00000-000"),e.find('input[name="homePhone"]').mask("(00) 0000-0000"),e.find('input[name="cellphone"]').mask(function(e){return 11===e.replace(/\D/g,"").length?"(00) 00000-0000":"(00) 0000-00009"},{onKeyPress:function(e,n,a,i){a.mask(SPMaskBehavior.apply({},arguments),i)}}),e.validate({rules:{email:{email:!0}},submitHandler:function(e){var n=$(e);if(n.valid()){var a=n.find('input[name="weddingAnniversary"], input[name="birthdate"]'),i=!1;if(a.each(function(){var e=$(this);moment(e.val(),"DD/MM/YYYY",!0).isValid()||(e.addClass("error"),e.is("[required]")&&(i=!0))}),i)return!1;n.addClass("qd-loading");var t=n.serializeObject();return $.ajax({url:"//api.vtexcrm.com.br/cartier/dataentities/DC/documents",type:"PATCH",dataType:"json",headers:{Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(t),success:function(e){$(".success-message").removeClass("hide"),$(".main-form").addClass("hide"),n.trigger("QD.crmSuccess",[e])},error:function(){alert("Desculpe, não foi possível enviar seu formulário!")},complete:function(){n.removeClass("qd-loading")}}),!1}},errorPlacement:function(e,n){}})}),$(window).on("QD.crmSuccess",function(e,n){$(".qd-v1-modal-newsletter");a="success"})}();