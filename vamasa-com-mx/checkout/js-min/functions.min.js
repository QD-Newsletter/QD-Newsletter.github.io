$(document).ready(function(){var a=$(".qd-v1-modal-newsletter");a.modal({backdrop:"static",keyboard:!1}),a.on("hidden.bs.modal",function(){window.parent.postMessage("QdSn2Msg|noclose","*")}),$(document).ready(function(){$("#dia_compra").mask("00/00/0000")})}),$(function(){var a=$("form"),r=(decodeURIComponent(window.location.search).match(/code=([^&]+)/)||[""]).pop().split("+");1<r.length&&($("#numero_pedido").val(r[0]||"").attr("readonly","readonly"),$("#dia_compra").val(moment(r[2]||"").format("DD/MM/YYYY")).attr("readonly","readonly")),a.validate({rules:{email:{email:!0}},submitHandler:function(a){var e=$(a);if(e.valid()){e.find("[name]");var o=e.find("#dia_compra");if(!moment(o.val(),"DD/MM/YYYY",!0).isValid())return o.addClass("error"),!1;e.addClass("qd-loading");var n=e.serializeObject();return n.dia_compra=1<r.length?r[2]||"":(n.dia_compra||"").split("/").reverse().join("-"),n.valor_pedido=1<r.length?"$ "+r[1]:"",$.ajax({url:"//api.vtexcrm.com.br/vamasa/dataentities/CF/documents",type:"PATCH",dataType:"json",headers:{Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(n),success:function(a){$(".success-mensaje").removeClass("hide"),$(".main-form").addClass("hide"),e.trigger("QD.crmSuccess",[a])},error:function(){alert("Desculpe, não foi possível enviar seu formulário!")},complete:function(){e.removeClass("qd-loading")}}),!1}},errorPlacement:function(a,e){}})});